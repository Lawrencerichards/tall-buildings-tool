{% extends "layout.html" %}

{% block head %}
  {{ super() }}
  <link href="/public/css/additional.css"  rel="stylesheet" type="text/css">
{% endblock %}

{% block content %}




<body class="govuk-template__body">
    <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>

    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="https://www.notifications.service.gov.uk" class="govuk-header__link govuk-header__link--homepage">
        <span class="govuk-header__logotype">
          <svg
            role="presentation"
            focusable="false"
            class="govuk-header__logotype-crown"
            xmlns="http://www.w3.org/2000/svg"
            viewbox="0 0 132 97"
            height="30"
            width="36"
          >
            <path
              fill="currentColor" fill-rule="evenodd"
              d="M25 30.2c3.5 1.5 7.7-.2 9.1-3.7 1.5-3.6-.2-7.8-3.9-9.2-3.6-1.4-7.6.3-9.1 3.9-1.4 3.5.3 7.5 3.9 9zM9 39.5c3.6 1.5 7.8-.2 9.2-3.7 1.5-3.6-.2-7.8-3.9-9.1-3.6-1.5-7.6.2-9.1 3.8-1.4 3.5.3 7.5 3.8 9zM4.4 57.2c3.5 1.5 7.7-.2 9.1-3.8 1.5-3.6-.2-7.7-3.9-9.1-3.5-1.5-7.6.3-9.1 3.8-1.4 3.5.3 7.6 3.9 9.1zm38.3-21.4c3.5 1.5 7.7-.2 9.1-3.8 1.5-3.6-.2-7.7-3.9-9.1-3.6-1.5-7.6.3-9.1 3.8-1.3 3.6.4 7.7 3.9 9.1zm64.4-5.6c-3.6 1.5-7.8-.2-9.1-3.7-1.5-3.6.2-7.8 3.8-9.2 3.6-1.4 7.7.3 9.2 3.9 1.3 3.5-.4 7.5-3.9 9zm15.9 9.3c-3.6 1.5-7.7-.2-9.1-3.7-1.5-3.6.2-7.8 3.7-9.1 3.6-1.5 7.7.2 9.2 3.8 1.5 3.5-.3 7.5-3.8 9zm4.7 17.7c-3.6 1.5-7.8-.2-9.2-3.8-1.5-3.6.2-7.7 3.9-9.1 3.6-1.5 7.7.3 9.2 3.8 1.3 3.5-.4 7.6-3.9 9.1zM89.3 35.8c-3.6 1.5-7.8-.2-9.2-3.8-1.4-3.6.2-7.7 3.9-9.1 3.6-1.5 7.7.3 9.2 3.8 1.4 3.6-.3 7.7-3.9 9.1zM69.7 17.7l8.9 4.7V9.3l-8.9 2.8c-.2-.3-.5-.6-.9-.9L72.4 0H59.6l3.5 11.2c-.3.3-.6.5-.9.9l-8.8-2.8v13.1l8.8-4.7c.3.3.6.7.9.9l-5 15.4v.1c-.2.8-.4 1.6-.4 2.4 0 4.1 3.1 7.5 7 8.1h.2c.3 0 .7.1 1 .1.4 0 .7 0 1-.1h.2c4-.6 7.1-4.1 7.1-8.1 0-.8-.1-1.7-.4-2.4V34l-5.1-15.4c.4-.2.7-.6 1-.9zM66 92.8c16.9 0 32.8 1.1 47.1 3.2 4-16.9 8.9-26.7 14-33.5l-9.6-3.4c1 4.9 1.1 7.2 0 10.2-1.5-1.4-3-4.3-4.2-8.7L108.6 76c2.8-2 5-3.2 7.5-3.3-4.4 9.4-10 11.9-13.6 11.2-4.3-.8-6.3-4.6-5.6-7.9 1-4.7 5.7-5.9 8-.5 4.3-8.7-3-11.4-7.6-8.8 7.1-7.2 7.9-13.5 2.1-21.1-8 6.1-8.1 12.3-4.5 20.8-4.7-5.4-12.1-2.5-9.5 6.2 3.4-5.2 7.9-2 7.2 3.1-.6 4.3-6.4 7.8-13.5 7.2-10.3-.9-10.9-8-11.2-13.8 2.5-.5 7.1 1.8 11 7.3L80.2 60c-4.1 4.4-8 5.3-12.3 5.4 1.4-4.4 8-11.6 8-11.6H55.5s6.4 7.2 7.9 11.6c-4.2-.1-8-1-12.3-5.4l1.4 16.4c3.9-5.5 8.5-7.7 10.9-7.3-.3 5.8-.9 12.8-11.1 13.8-7.2.6-12.9-2.9-13.5-7.2-.7-5 3.8-8.3 7.1-3.1 2.7-8.7-4.6-11.6-9.4-6.2 3.7-8.5 3.6-14.7-4.6-20.8-5.8 7.6-5 13.9 2.2 21.1-4.7-2.6-11.9.1-7.7 8.8 2.3-5.5 7.1-4.2 8.1.5.7 3.3-1.3 7.1-5.7 7.9-3.5.7-9-1.8-13.5-11.2 2.5.1 4.7 1.3 7.5 3.3l-4.7-15.4c-1.2 4.4-2.7 7.2-4.3 8.7-1.1-3-.9-5.3 0-10.2l-9.5 3.4c5 6.9 9.9 16.7 14 33.5 14.8-2.1 30.8-3.2 47.7-3.2z"
            ></path>
            <image src="/assets/images/govuk-logotype-crown.png" xlink:href="" class="govuk-header__logotype-crown-fallback-image" width="36" height="32"></image>
          </svg>
          <span class="govuk-header__logotype-text">
            GOV.UK
          </span>
        </span>
        <span class="govuk-header__product-name">
          Notify
        </span>
      </a>
    </div>
    <div class="govuk-header__content">
      <button type="button" role="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" aria-label="Show or hide Top Level Navigation">Menu</button>
      <nav>
        <ul id="navigation" class="govuk-header__navigation govuk-header__navigation--end" aria-label="Top Level Navigation">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="https://www.notifications.service.gov.uk/support">Support</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="https://www.notifications.service.gov.uk/features">Features</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="https://www.notifications.service.gov.uk/pricing">Pricing</a>
            </li>
            <li class="govuk-header__navigation-item govuk-header__navigation-item--active">
              <a class="govuk-header__link" href="https://www.notifications.service.gov.uk/documentation">Documentation</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <a href="#toc" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </a>
        </div>

      <div class="app-pane__body" data-module="in-page-navigation">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents">

              <a href="#" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></a>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                      <ul>
  <li>
    <a href="#node-js-client-documentation"><span>Node.js client documentation</span></a>
  </li>
  <li>
    <a href="#set-up-the-client"><span>Set up the client</span></a>
    <ul>
      <li>
        <a href="#install-the-client"><span>Install the client</span></a>
      </li>
      <li>
        <a href="#create-a-new-instance-of-the-client"><span>Create a new instance of the client</span></a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#send-a-message-2"><span>Send a message</span></a>
    <ul>
      <li>
        <a href="#send-a-text-message"><span>Send a text message</span></a>
      </li>
      <li>
        <a href="#send-an-email"><span>Send an email</span></a>
      </li>
      <li>
        <a href="#send-a-file-by-email"><span>Send a file by email</span></a>
      </li>
      <li>
        <a href="#send-a-letter"><span>Send a letter</span></a>
      </li>
      <li>
        <a href="#send-a-precompiled-letter"><span>Send a precompiled letter</span></a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#get-message-status-2"><span>Get message status</span></a>
    <ul>
      <li>
        <a href="#status-email"><span>Status - email</span></a>
      </li>
      <li>
        <a href="#status-text-message"><span>Status - text message</span></a>
      </li>
      <li>
        <a href="#status-letter"><span>Status - letter</span></a>
      </li>
      <li>
        <a href="#status-precompiled-letter"><span>Status - precompiled letter</span></a>
      </li>
      <li>
        <a href="#get-the-status-of-one-message"><span>Get the status of one message</span></a>
      </li>
      <li>
        <a href="#get-the-status-of-multiple-messages"><span>Get the status of multiple messages</span></a>
      </li>
      <li>
        <a href="#get-a-pdf-for-a-letter-notification"><span>Get a PDF for a letter notification</span></a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#get-a-template"><span>Get a template</span></a>
    <ul>
      <li>
        <a href="#get-a-template-by-id"><span>Get a template by ID</span></a>
      </li>
      <li>
        <a href="#get-a-template-by-id-and-version"><span>Get a template by ID and version</span></a>
      </li>
      <li>
        <a href="#get-all-templates"><span>Get all templates</span></a>
      </li>
      <li>
        <a href="#generate-a-preview-template"><span>Generate a preview template</span></a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#get-received-text-messages"><span>Get received text messages</span></a>
    <ul>
      <li>
        <a href="#enable-received-text-messages"><span>Enable received text messages</span></a>
      </li>
      <li>
        <a href="#get-a-page-of-received-text-messages"><span>Get a page of received text messages</span></a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#testing"><span>Testing</span></a>
    <ul>
      <li>
        <a href="#smoke-testing"><span>Smoke testing</span></a>
      </li>
      <li>
        <a href="#other-testing"><span>Other testing</span></a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#api-keys"><span>API keys</span></a>
    <ul>
      <li>
        <a href="#test"><span>Test</span></a>
      </li>
      <li>
        <a href="#team-and-guest-list"><span>Team and guest list</span></a>
      </li>
      <li>
        <a href="#live"><span>Live</span></a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#limits"><span>Limits</span></a>
    <ul>
      <li>
        <a href="#rate-limits"><span>Rate limits</span></a>
      </li>
      <li>
        <a href="#daily-limits"><span>Daily limits</span></a>
      </li>
      <li>
        <a href="#phone-network-limits"><span>Phone network limits</span></a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#callbacks"><span>Callbacks</span></a>
    <ul>
      <li>
        <a href="#set-up-callbacks"><span>Set up callbacks</span></a>
      </li>
      <li>
        <a href="#delivery-receipts"><span>Delivery receipts</span></a>
      </li>
      <li>
        <a href="#received-text-messages"><span>Received text messages</span></a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#api-architecture"><span>API architecture</span></a>
    <ul>
      <li>
        <a href="#send-a-message"><span>Send a message</span></a>
      </li>
      <li>
        <a href="#get-message-status"><span>Get message status</span></a>
      </li>
      <li>
        <a href="#get-inbound-messages"><span>Get inbound messages</span></a>
      </li>
    </ul>
  </li>
  <li>
    <a href="#support"><span>Support</span></a>
  </li>
</ul>


              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
            <h1 id="node-js-client-documentation">Node.js client documentation</h1><p>This documentation is for developers interested in using the GOV.UK Notify Node.js client to send emails, text messages or letters.</p>
<h1 id="set-up-the-client">Set up the client</h1><h2 id="install-the-client">Install the client</h2><p>Run the following in the command line:</p>
<div class="highlight"><pre class="highlight shell"><code>npm install <span class="nt">--save</span> notifications-node-client
</code></pre></div><h2 id="create-a-new-instance-of-the-client">Create a new instance of the client</h2><p>Add this code to your application:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">NotifyClient</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'notifications-node-client'</span><span class="p">).</span><span class="nx">NotifyClient</span>

<span class="kd">var</span> <span class="nx">notifyClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">NotifyClient</span><span class="p">(</span><span class="nx">apiKey</span><span class="p">)</span>
</code></pre></div><p>To get an API key, <a href="https://www.notifications.service.gov.uk/sign-in">sign in to GOV.UK Notify</a> and go to the <strong>API integration</strong> page. You can find more information in the <a href="#api-keys">API keys</a> section of this documentation.</p>
<h3 id="connect-through-a-proxy-optional">Connect through a proxy (optional)</h3><p>Add this code to your application:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="nx">notifyClient</span><span class="p">.</span><span class="nx">setProxy</span><span class="p">(</span><span class="nx">proxyUrl</span><span class="p">)</span>
</code></pre></div><h1 id="send-a-message-2">Send a message</h1><p>You can use GOV.UK Notify to send text messages, emails (including documents) and letters.</p>
<h2 id="send-a-text-message">Send a text message</h2><h3 id="method">Method</h3><div class="highlight"><pre class="highlight javascript"><code><span class="nx">notifyClient</span>
  <span class="p">.</span><span class="nx">sendSms</span><span class="p">(</span><span class="nx">templateId</span><span class="p">,</span> <span class="nx">phoneNumber</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">personalisation</span><span class="p">:</span> <span class="nx">personalisation</span><span class="p">,</span>
    <span class="na">reference</span><span class="p">:</span> <span class="nx">reference</span><span class="p">,</span>
    <span class="na">smsSenderId</span><span class="p">:</span> <span class="nx">smsSenderId</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre></div><p>The method returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises">promise</a> [external link]. The promise will either:</p>

<ul>
<li>resolve with a <code>response</code> if successful</li>
<li>fail with an <code>err</code> if unsuccessful</li>
</ul>
<h3 id="arguments">Arguments</h3><h4 id="templateid-required">templateId (required)</h4><p>To find the template ID:</p>

<ol>
<li><a href="https://www.notifications.service.gov.uk/sign-in">Sign in to GOV.UK Notify</a>.</li>
<li>Go to the <strong>Templates</strong> page and select the relevant template.</li>
<li>Select <strong>Copy template ID to clipboard</strong>.</li>
</ol>
<p>For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>'f33517ff-2a88-4f6e-b855-c550268ce08a'
</code></pre></div><h4 id="phonenumber-required">phoneNumber (required)</h4><p>The phone number of the recipient of the text message. This number can be a UK or international number. For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>'+447900900123'
</code></pre></div><h4 id="personalisation-required">personalisation (required)</h4><p>If a template has placeholder fields for personalised information such as name or reference number, you must provide their values in an <code>object</code>. For example:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s1">'first_name'</span><span class="p">:</span> <span class="s1">'Amala'</span><span class="p">,</span>
  <span class="s1">'reference_number'</span><span class="p">:</span> <span class="s1">'300241'</span>
<span class="p">}</span>
</code></pre></div><h4 id="reference-required">reference (required)</h4><p>A unique identifier you create. This reference identifies a single unique notification or a batch of notifications. It must not contain any personal information such as name or postal address. If you do not have a reference, you must pass in an empty string or <code>null</code>. For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>'your_reference_here'
</code></pre></div><h4 id="smssenderid-optional">smsSenderId (optional)</h4><p>A unique identifier of the sender of the text message notification. For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>'8e222534-7f05-4972-86e3-17c5d9f894e2'
</code></pre></div><p>To find the text message sender:</p>

<ol>
<li><a href="https://www.notifications.service.gov.uk/sign-in">Sign in to GOV.UK Notify</a>.</li>
<li>Go to the <strong>Settings</strong> page.</li>
<li>In the <strong>Text Messages</strong> section, select <strong>Manage</strong> on the <strong>Text Message sender</strong> row.</li>
</ol>
<p>In this screen, you can either:</p>

<ul>
<li>copy the sender ID that you want to use and paste it into the method</li>
<li>select <strong>Change</strong> to change the default sender that the service will use, and select <strong>Save</strong></li>
</ul>
<p>You can leave out this argument if your service only has one text message sender, or if you want to use the default sender.</p>
<h3 id="response">Response</h3><p>If the request to the client is successful, the promise resolves with an <code>object</code>:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'bfb50d92-100d-4b8b-b559-14fa3b091cda'</span><span class="p">,</span>
  <span class="s1">'reference'</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
  <span class="s1">'content'</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'body'</span><span class="p">:</span> <span class="s1">'Some words'</span><span class="p">,</span>
    <span class="s1">'from_number'</span><span class="p">:</span> <span class="s1">'40604'</span>
  <span class="p">},</span>
  <span class="s1">'uri'</span><span class="p">:</span> <span class="s1">'https://api.notifications.service.gov.uk/v2/notifications/ceb50d92-100d-4b8b-b559-14fa3b091cd'</span><span class="p">,</span>
  <span class="s1">'template'</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'ceb50d92-100d-4b8b-b559-14fa3b091cda'</span><span class="p">,</span>
    <span class="s1">'version'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">'uri'</span><span class="p">:</span> <span class="s1">'https://api.notifications.service.gov.uk/v2/templates/bfb50d92-100d-4b8b-b559-14fa3b091cda'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>If you are using the <a href="#test">test API key</a>, all your messages come back with a <code>delivered</code> status.</p>
<p>All messages sent using the <a href="#team-and-guest-list">team and guest list</a> or <a href="#live">live</a> keys appear on your dashboard.</p>
<h3 id="error-codes">Error codes</h3><p>If the request is not successful, the promise fails with an <code>err</code>.</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">err.error.status_code</th>
<th style="text-align: left">err.error.errors</th>
<th style="text-align: left">How to fix</th>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;Can&#39;t send to this recipient using a team-only API key&quot;</code><br><code>]}</code></td>
<td style="text-align: left">Use the correct type of <a href="#api-keys">API key</a></td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;Can&#39;t send to this recipient when service is in trial mode - see https://www.notifications.service.gov.uk/trial-mode&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Your service cannot send this notification in <a href="https://www.notifications.service.gov.uk/features/using-notify#trial-mode">trial mode</a></td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Error: Your system clock must be accurate to within 30 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check your system clock</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Invalid token: API key not found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Use the correct API key. Refer to <a href="#api-keys">API keys</a> for more information</td>
</tr>
<tr>
<td style="text-align: left"><code>429</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;RateLimitError&quot;,</code><br><code>&quot;message&quot;: &quot;Exceeded rate limit for key type TEAM/TEST/LIVE of 3000 requests per 60 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Refer to <a href="#rate-limits">API rate limits</a> for more information</td>
</tr>
<tr>
<td style="text-align: left"><code>429</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;TooManyRequestsError&quot;,</code><br><code>&quot;message&quot;: &quot;Exceeded send limits (LIMIT NUMBER) for today&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Refer to <a href="#daily-limits">service limits</a> for the limit number</td>
</tr>
<tr>
<td style="text-align: left"><code>500</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;Exception&quot;,</code><br><code>&quot;message&quot;: &quot;Internal server error&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Notify was unable to process the request, resend your notification</td>
</tr>

        </table>
      </div><h2 id="send-an-email">Send an email</h2><h3 id="send-an-email-method">Method</h3><div class="highlight"><pre class="highlight javascript"><code><span class="nx">notifyClient</span>
  <span class="p">.</span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">templateId</span><span class="p">,</span> <span class="nx">emailAddress</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">personalisation</span><span class="p">:</span> <span class="nx">personalisation</span><span class="p">,</span>
    <span class="na">reference</span><span class="p">:</span> <span class="nx">reference</span><span class="p">,</span>
    <span class="na">emailReplyToId</span><span class="p">:</span> <span class="nx">emailReplyToId</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre></div><p>The method returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises">promise</a> [external link]. The promise will either:</p>

<ul>
<li>resolve with a <code>response</code> if successful</li>
<li>fail with an <code>err</code> if unsuccessful</li>
</ul>
<h3 id="send-an-email-arguments">Arguments</h3><h4 id="send-an-email-arguments-templateid-required">templateId (required)</h4><p>To find the template ID:</p>

<ol>
<li><a href="https://www.notifications.service.gov.uk/sign-in">Sign in to GOV.UK Notify</a>.</li>
<li>Go to the <strong>Templates</strong> page and select the relevant template.</li>
<li>Select <strong>Copy template ID to clipboard</strong>.</li>
</ol>
<p>For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>"f33517ff-2a88-4f6e-b855-c550268ce08a"
</code></pre></div><h4 id="emailaddress-required">emailAddress (required)</h4><p>The email address of the recipient. For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>"sender@something.com"
</code></pre></div><h4 id="send-an-email-arguments-personalisation-required">personalisation (required)</h4><p>If a template has placeholder fields for personalised information such as name or application date, you must provide their values in an <code>object</code>. For example:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="nl">personalisation</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'first_name'</span><span class="p">:</span> <span class="s1">'Amala'</span><span class="p">,</span>
    <span class="s1">'application_number'</span><span class="p">:</span> <span class="s1">'300241'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h4 id="send-an-email-arguments-reference-required">reference (required)</h4><p>A unique identifier you create. This reference identifies a single unique notification or a batch of notifications. It must not contain any personal information such as name or postal address. If you do not have a reference, you must pass in an empty string or <code>null</code>. For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>"your_reference_here"
</code></pre></div><h4 id="emailreplytoid-optional">emailReplyToId (optional)</h4><p>This is an email address specified by you to receive replies from your users. You must add at least one reply-to email address before your service can go live.</p>
<p>To add a reply-to email address:</p>

<ol>
<li><a href="https://www.notifications.service.gov.uk/sign-in">Sign in to GOV.UK Notify</a>.</li>
<li>Go to the <strong>Settings</strong> page.</li>
<li>In the <strong>Email</strong> section, select <strong>Manage</strong> on the <strong>Reply-to email addresses</strong> row.</li>
<li>Select <strong>Add reply-to address</strong>.</li>
<li>Enter the email address you want to use, and select <strong>Add</strong>.</li>
</ol>
<div class="highlight"><pre class="highlight plaintext"><code>emailReplyToId='8e222534-7f05-4972-86e3-17c5d9f894e2'
</code></pre></div><p>You can leave out this argument if your service only has one reply-to email address, or you want to use the default email address.</p>
<h3 id="send-an-email-response">Response</h3><p>If the request to the client is successful, the promise resolves with an <code>object</code>:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'bfb50d92-100d-4b8b-b559-14fa3b091cda'</span><span class="p">,</span>
  <span class="s1">'reference'</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
  <span class="s1">'content'</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'subject'</span><span class="p">:</span> <span class="s1">'Licence renewal'</span><span class="p">,</span>
    <span class="s1">'body'</span><span class="p">:</span> <span class="s1">'Dear Bill, your licence is due for renewal on 3 January 2016.'</span><span class="p">,</span>
    <span class="s1">'from_email'</span><span class="p">:</span> <span class="s1">'the_service@gov.uk'</span>
  <span class="p">},</span>
  <span class="s1">'uri'</span><span class="p">:</span> <span class="s1">'https://api.notifications.service.gov.uk/v2/notifications/ceb50d92-100d-4b8b-b559-14fa3b091cd'</span><span class="p">,</span>
  <span class="s1">'template'</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'ceb50d92-100d-4b8b-b559-14fa3b091cda'</span><span class="p">,</span>
    <span class="s1">'version'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">'uri'</span><span class="p">:</span> <span class="s1">'https://api.notificaitons.service.gov.uk/service/your_service_id/templates/bfb50d92-100d-4b8b-b559-14fa3b091cda'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h3 id="send-an-email-error-codes">Error codes</h3><p>If the request is not successful, the promise fails with an <code>err</code>.</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">err.error.status_code</th>
<th style="text-align: left">err.error.errors</th>
<th style="text-align: left">How to fix</th>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;Can&#39;t send to this recipient using a team-only API key&quot;</code><br><code>]}</code></td>
<td style="text-align: left">Use the correct type of <a href="#api-keys">API key</a></td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;Can&#39;t send to this recipient when service is in trial mode - see https://www.notifications.service.gov.uk/trial-mode&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Your service cannot send this notification in <a href="https://www.notifications.service.gov.uk/features/using-notify#trial-mode">trial mode</a></td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Error: Your system clock must be accurate to within 30 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check your system clock</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Invalid token: API key not found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Use the correct API key. Refer to <a href="#api-keys">API keys</a> for more information</td>
</tr>
<tr>
<td style="text-align: left"><code>429</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;RateLimitError&quot;,</code><br><code>&quot;message&quot;: &quot;Exceeded rate limit for key type TEAM/TEST/LIVE of 3000 requests per 60 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Refer to <a href="#rate-limits">API rate limits</a> for more information</td>
</tr>
<tr>
<td style="text-align: left"><code>429</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;TooManyRequestsError&quot;,</code><br><code>&quot;message&quot;: &quot;Exceeded send limits (LIMIT NUMBER) for today&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Refer to <a href="#daily-limits">service limits</a> for the limit number</td>
</tr>
<tr>
<td style="text-align: left"><code>500</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;Exception&quot;,</code><br><code>&quot;message&quot;: &quot;Internal server error&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Notify was unable to process the request, resend your notification</td>
</tr>

        </table>
      </div><h2 id="send-a-file-by-email">Send a file by email</h2><p>To send a file by email, add a placeholder to the template then upload a file. The placeholder will contain a secure link to download the file.</p>
<p>The links are unique and unguessable. GOV.UK Notify cannot access or decrypt your file.</p>
<h3 id="add-contact-details-to-the-file-download-page">Add contact details to the file download page</h3>
<ol>
<li><a href="https://www.notifications.service.gov.uk/sign-in">Sign in to GOV.UK Notify</a>.</li>
<li>Go to the <strong>Settings</strong> page.</li>
<li>In the <strong>Email</strong> section, select <strong>Manage</strong> on the <strong>Send files by email</strong> row.</li>
<li>Enter the contact details you want to use, and select <strong>Save</strong>.</li>
</ol>
<h3 id="add-a-placeholder-to-the-template">Add a placeholder to the template</h3>
<ol>
<li><a href="https://www.notifications.service.gov.uk/sign-in">Sign in to GOV.UK Notify</a>.</li>
<li>Go to the <strong>Templates</strong> page and select the relevant email template.</li>
<li>Select <strong>Edit</strong>.</li>
<li>Add a placeholder to the email template using double brackets. For example:</li>
</ol>
<p>&ldquo;Download your file at: ((link_to_file))&rdquo;</p>
<h3 id="upload-your-file">Upload your file</h3><p>You can upload PDF, CSV, .odt, .txt and MS Word Document files. Your file must be smaller than 2MB. <a href="https://www.notifications.service.gov.uk/support/ask-question-give-feedback">Contact the GOV.UK Notify team</a> if you need to send other file types.</p>
<p>Pass the file object as a value into the <code>personalisation</code> argument. For example:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'fs'</span><span class="p">)</span>

<span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s1">'path/to/document.pdf'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">pdfFile</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
  <span class="nx">notifyClient</span><span class="p">.</span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">templateId</span><span class="p">,</span> <span class="nx">emailAddress</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">personalisation</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">first_name</span><span class="p">:</span> <span class="s1">'Amala'</span><span class="p">,</span>
      <span class="na">application_date</span><span class="p">:</span> <span class="s1">'2018-01-01'</span><span class="p">,</span>
      <span class="na">link_to_file</span><span class="p">:</span> <span class="nx">notifyClient</span><span class="p">.</span><span class="nx">prepareUpload</span><span class="p">(</span><span class="nx">pdfFile</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">body</span><span class="p">)).</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
<span class="p">})</span>
</code></pre></div><p>The method returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises">promise</a> [external link]. The promise will either:</p>

<ul>
<li>resolve with a <code>response</code> if successful</li>
<li>fail with an <code>err</code> if unsuccessful</li>
</ul>
<h4 id="csv-files">CSV Files</h4><p>Uploads for CSV files should use the <code>isCsv</code> parameter on the <code>prepareUpload()</code> function.  For example:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'fs'</span><span class="p">)</span>

<span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s1">'path/to/document.csv'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">csvFile</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
  <span class="nx">notifyClient</span><span class="p">.</span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">templateId</span><span class="p">,</span> <span class="nx">emailAddress</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">personalisation</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">first_name</span><span class="p">:</span> <span class="s1">'Amala'</span><span class="p">,</span>
      <span class="na">application_date</span><span class="p">:</span> <span class="s1">'2018-01-01'</span><span class="p">,</span>
      <span class="na">link_to_file</span><span class="p">:</span> <span class="nx">notifyClient</span><span class="p">.</span><span class="nx">prepareUpload</span><span class="p">(</span><span class="nx">csvFile</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">body</span><span class="p">)).</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
<span class="p">})</span>
</code></pre></div><h3 id="send-a-file-by-email-response">Response</h3><p>If the request to the client is successful, the promise resolves with an <code>object</code>:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'740e5834-3a29-46b4-9a6f-16142fde533a'</span><span class="p">,</span>
  <span class="s1">'reference'</span><span class="p">:</span> <span class="s1">'your_reference_here'</span><span class="p">,</span>
  <span class="s1">'content'</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'subject'</span><span class="p">:</span> <span class="s1">'SUBJECT TEXT'</span><span class="p">,</span>
    <span class="s1">'body'</span><span class="p">:</span> <span class="s1">'MESSAGE TEXT'</span><span class="p">,</span>
    <span class="s1">'from_email'</span><span class="p">:</span> <span class="s1">'SENDER EMAIL'</span>
  <span class="p">},</span>
  <span class="s1">'uri'</span><span class="p">:</span> <span class="s1">'https://api.notifications.service.gov.uk/v2/notifications/740e5834-3a29-46b4-9a6f-16142fde533a'</span><span class="p">,</span>
  <span class="s1">'template'</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'f33517ff-2a88-4f6e-b855-c550268ce08a'</span><span class="p">,</span>
    <span class="s1">'version'</span><span class="p">:</span> <span class="nx">INTEGER</span><span class="p">,</span>
    <span class="s1">'uri'</span><span class="p">:</span> <span class="s1">'https://api.notifications.service.gov.uk/v2/template/f33517ff-2a88-4f6e-b855-c550268ce08a'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h3 id="send-a-file-by-email-error-codes">Error codes</h3><p>If the request is not successful, the promise fails with an <code>err</code>.</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">err.error.status_code</th>
<th style="text-align: left">err.error.errors</th>
<th style="text-align: left">How to fix</th>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;Can&#39;t send to this recipient using a team-only API key&quot;</code><br><code>]}</code></td>
<td style="text-align: left">Use the correct type of <a href="#api-keys">API key</a></td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;Can&#39;t send to this recipient when service is in trial mode - see https://www.notifications.service.gov.uk/trial-mode&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Your service cannot send this notification in <a href="https://www.notifications.service.gov.uk/features/using-notify#trial-mode">trial mode</a></td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;Unsupported file type &#39;(FILE TYPE)&#39;. Supported types are: &#39;(ALLOWED TYPES)&#39;&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Wrong file type. You can only upload .pdf, .csv, .txt, .doc, .docx or .odt files</td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;File did not pass the virus scan&quot;</code><br><code>}]</code></td>
<td style="text-align: left">The file contains a virus</td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;Send files by email has not been set up - add contact details for your service at https://www.notifications.service.gov.uk/services/(SERVICE ID)/service-settings/send-files-by-email&quot;</code><br><code>}]</code></td>
<td style="text-align: left">See how to <a href="#add-contact-details-to-the-file-download-page">add contact details to the file download page</a></td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Error: Your system clock must be accurate to within 30 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check your system clock</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Invalid token: API key not found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Use the correct API key. Refer to <a href="#api-keys">API keys</a> for more information</td>
</tr>
<tr>
<td style="text-align: left"><code>429</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;RateLimitError&quot;,</code><br><code>&quot;message&quot;: &quot;Exceeded rate limit for key type TEAM/TEST/LIVE of 3000 requests per 60 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Refer to <a href="#rate-limits">API rate limits</a> for more information</td>
</tr>
<tr>
<td style="text-align: left"><code>429</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;TooManyRequestsError&quot;,</code><br><code>&quot;message&quot;: &quot;Exceeded send limits (LIMIT NUMBER) for today&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Refer to <a href="#daily-limits">service limits</a> for the limit number</td>
</tr>
<tr>
<td style="text-align: left"><code>500</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;Exception&quot;,</code><br><code>&quot;message&quot;: &quot;Internal server error&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Notify was unable to process the request, resend your notification.</td>
</tr>
<tr>
<td style="text-align: left"><code>N/A</code></td>
<td style="text-align: left"><code>File is larger than 2MB</code></td>
<td style="text-align: left">The file is too big. Files must be smaller than 2MB</td>
</tr>

        </table>
      </div><h2 id="send-a-letter">Send a letter</h2><p>When you add a new service it will start in <a href="https://www.notifications.service.gov.uk/features/trial-mode">trial mode</a>. You can only send letters when your service is live.</p>
<p>To send Notify a request to go live:</p>

<ol>
<li><a href="https://www.notifications.service.gov.uk/sign-in">Sign in to GOV.UK Notify</a>.</li>
<li>Go to the <strong>Settings</strong> page.</li>
<li>In the <strong>Your service is in trial mode</strong> section, select <strong>request to go live</strong>.</li>
</ol>
<h3 id="send-a-letter-method">Method</h3><div class="highlight"><pre class="highlight javascript"><code><span class="nx">notifyClient</span>
  <span class="p">.</span><span class="nx">sendLetter</span><span class="p">(</span><span class="nx">templateId</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">personalisation</span><span class="p">:</span> <span class="nx">personalisation</span><span class="p">,</span>
    <span class="na">reference</span><span class="p">:</span> <span class="nx">reference</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre></div><p>The method returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises">promise</a> [external link]. The promise will either:</p>

<ul>
<li>resolve with a <code>response</code> if successful</li>
<li>fail with an <code>err</code> if unsuccessful</li>
</ul>
<h3 id="send-a-letter-arguments">Arguments</h3><h4 id="send-a-letter-arguments-templateid-required">templateId (required)</h4><p>To find the template ID:</p>

<ol>
<li><a href="https://www.notifications.service.gov.uk/sign-in">Sign in to GOV.UK Notify</a>.</li>
<li>Go to the <strong>Templates</strong> page and select the relevant template.</li>
<li>Select <strong>Copy template ID to clipboard</strong>.</li>
</ol>
<p>For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>"f33517ff-2a88-4f6e-b855-c550268ce08a"
</code></pre></div><h4 id="send-a-letter-arguments-personalisation-required">personalisation (required)</h4><p>The personalisation argument always contains the following parameters for the letter recipient’s address:</p>

<ul>
<li><code>address_line_1</code></li>
<li><code>address_line_2</code></li>
<li><code>postcode</code> (this needs to be a real UK postcode)</li>
</ul>
<p>Any other placeholder fields included in the letter template also count as required parameters. You must provide their values in an <code>object</code>. For example:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="nl">personalisation</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'address_line_1'</span><span class="p">:</span> <span class="s1">'The Occupier'</span><span class="p">,</span>
    <span class="s1">'address_line_2'</span><span class="p">:</span> <span class="s1">'123 High Street'</span><span class="p">,</span>
    <span class="s1">'postcode'</span><span class="p">:</span> <span class="s1">'SW14 6BH'</span><span class="p">,</span>
    <span class="s1">'application_date'</span><span class="p">:</span> <span class="s1">'2018-01-01'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h4 id="personalisation-optional">personalisation (optional)</h4><p>The following parameters in the letter recipient’s address are optional:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="nl">personalisation</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'address_line_3'</span><span class="p">:</span> <span class="s1">'Richmond upon Thames'</span><span class="p">,</span>
    <span class="s1">'address_line_4'</span><span class="p">:</span> <span class="s1">'London'</span><span class="p">,</span>
    <span class="s1">'address_line_5'</span><span class="p">:</span> <span class="s1">'Middlesex'</span><span class="p">,</span>
    <span class="s1">'address_line_6'</span><span class="p">:</span> <span class="s1">'UK'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h4 id="reference-optional">reference (optional)</h4><p>A unique identifier you can create if required. This reference identifies a single unique notification or a batch of notifications. It must not contain any personal information such as name or postal address. For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>"your_reference_here"
</code></pre></div><h3 id="send-a-letter-response">Response</h3><p>If the request to the client is successful, the promise resolves with an <code>object</code>:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'740e5834-3a29-46b4-9a6f-16142fde533a'</span><span class="p">,</span>
  <span class="s1">'reference'</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
  <span class="s1">'content'</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'subject'</span><span class="p">:</span> <span class="s1">'Licence renewal'</span><span class="p">,</span>
    <span class="s1">'body'</span><span class="p">:</span> <span class="s1">'Dear Bill, your licence is due for renewal on 3 January 2016.'</span>
  <span class="p">},</span>
  <span class="s1">'uri'</span><span class="p">:</span> <span class="s1">'https://api.notifications.service.gov.uk/v2/notifications/740e5834-3a29-46b4-9a6f-16142fde533a'</span><span class="p">,</span>
  <span class="s1">'template'</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'f33517ff-2a88-4f6e-b855-c550268ce08a'</span><span class="p">,</span>
    <span class="s1">'version'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">'uri'</span><span class="p">:</span> <span class="s1">'https://api.notifications.service.gov.uk/v2/template/f33517ff-2a88-4f6e-b855-c550268ce08a'</span>
  <span class="p">},</span>
  <span class="s1">'scheduled_for'</span><span class="p">:</span> <span class="kc">null</span>
<span class="p">}</span>
</code></pre></div><h3 id="send-a-letter-error-codes">Error codes</h3><p>If the request is not successful, the promise fails with an <code>err</code>.</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">err.error.status_code</th>
<th style="text-align: left">err.error.errors</th>
<th style="text-align: left">How to fix</th>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;Cannot send letters with a team api key&quot;</code><br><code>]}</code></td>
<td style="text-align: left">Use the correct type of <a href="#api-keys">API key</a></td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;Cannot send letters when service is in trial mode - see https://www.notifications.service.gov.uk/trial-mode&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Your service cannot send this notification in <a href="https://www.notifications.service.gov.uk/features/using-notify#trial-mode">trial mode</a></td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;ValidationError&quot;,</code><br><code>&quot;message&quot;: &quot;personalisation address_line_1 is a required property&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Ensure that your template has a field for the first line of the address, refer to <a href="#send-a-letter-arguments-personalisation-required">personalisation</a> for more information</td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;ValidationError&quot;,</code><br><code>&quot;message&quot;: &quot;Must be a real UK postcode&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Ensure that the value for the postcode field in your letter is a real UK postcode</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Error: Your system clock must be accurate to within 30 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check your system clock</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Invalid token: API key not found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Use the correct API key. Refer to <a href="#api-keys">API keys</a> for more information</td>
</tr>
<tr>
<td style="text-align: left"><code>429</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;RateLimitError&quot;,</code><br><code>&quot;message&quot;: &quot;Exceeded rate limit for key type TEAM/TEST/LIVE of 3000 requests per 60 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Refer to <a href="#rate-limits">API rate limits</a> for more information</td>
</tr>
<tr>
<td style="text-align: left"><code>429</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;TooManyRequestsError&quot;,</code><br><code>&quot;message&quot;: &quot;Exceeded send limits (LIMIT NUMBER) for today&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Refer to <a href="#daily-limits">service limits</a> for the limit number</td>
</tr>
<tr>
<td style="text-align: left"><code>500</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;Exception&quot;,</code><br><code>&quot;message&quot;: &quot;Internal server error&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Notify was unable to process the request, resend your notification</td>
</tr>

        </table>
      </div><h2 id="send-a-precompiled-letter">Send a precompiled letter</h2><h3 id="send-a-precompiled-letter-method">Method</h3><div class="highlight"><pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">notifyClient</span><span class="p">.</span><span class="nx">sendPrecompiledLetter</span><span class="p">(</span>
  <span class="nx">reference</span><span class="p">,</span>
  <span class="nx">pdfFile</span><span class="p">,</span>
  <span class="nx">postage</span>
<span class="p">)</span>
</code></pre></div><h3 id="send-a-precompiled-letter-arguments">Arguments</h3><h4 id="send-a-precompiled-letter-arguments-reference-required">reference (required)</h4><p>A unique identifier you create. This reference identifies a single unique notification or a batch of notifications. It must not contain any personal information such as name or postal address. For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>"your_reference_here"
</code></pre></div><h4 id="pdffile">pdfFile</h4><p>The precompiled letter must be a PDF file which meets <a href="https://docs.notifications.service.gov.uk/documentation/images/notify-pdf-letter-spec-v2.4.pdf">the GOV.UK Notify PDF letter specification</a>. For example:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'fs'</span><span class="p">)</span>

<span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s1">'path/to/document.pdf'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">pdfFile</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="kd">var</span> <span class="nx">notification</span> <span class="o">=</span> <span class="nx">notifyClient</span><span class="p">.</span><span class="nx">sendPrecompiledLetter</span><span class="p">(</span>
    <span class="s1">'your reference'</span><span class="p">,</span> <span class="nx">pdfFile</span>
  <span class="p">)</span>
<span class="p">})</span>
</code></pre></div><h4 id="postage-optional">postage (optional)</h4><p>You can choose first or second class postage for your precompiled letter. Set the value to <code>first</code> for first class, or <code>second</code> for second class. If you do not pass in this argument, the postage will default to second class.</p>
<h3 id="send-a-precompiled-letter-response">Response</h3><p>If the request to the client is successful, the promise resolves with an <code>object</code>:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'740e5834-3a29-46b4-9a6f-16142fde533a'</span><span class="p">,</span>
  <span class="s1">'reference'</span><span class="p">:</span> <span class="s1">'your-letter-reference'</span><span class="p">,</span>
  <span class="s1">'postage'</span><span class="p">:</span> <span class="s1">'second'</span>
<span class="p">}</span>
</code></pre></div><h3 id="send-a-precompiled-letter-error-codes">Error codes</h3><p>If the request is not successful, the promise fails with an <code>err</code>.</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">err.error.status_code</th>
<th style="text-align: left">err.error.errors</th>
<th style="text-align: left">How to fix</th>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;Cannot send letters with a team api key&quot;</code><br><code>]}</code></td>
<td style="text-align: left">Use the correct type of <a href="#api-keys">API key</a></td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;Cannot send letters when service is in trial mode - see https://www.notifications.service.gov.uk/trial-mode&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Your service cannot send this notification in <a href="https://www.notifications.service.gov.uk/features/using-notify#trial-mode">trial mode</a></td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;ValidationError&quot;,</code><br><code>&quot;message&quot;: &quot;personalisation address_line_1 is a required property&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Send a valid PDF file</td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;ValidationError&quot;,</code><br><code>&quot;message&quot;: &quot;postage invalid. It must be either first or second.&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Change the value of <code>postage</code> argument in the method call to either &lsquo;first&rsquo; or &#39;second&rsquo;</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Error: Your system clock must be accurate to within 30 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check your system clock</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Invalid token: API key not found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Use the correct API key. Refer to <a href="#api-keys">API keys</a> for more information</td>
</tr>
<tr>
<td style="text-align: left"><code>429</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;RateLimitError&quot;,</code><br><code>&quot;message&quot;: &quot;Exceeded rate limit for key type TEAM/TEST/LIVE of 3000 requests per 60 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Refer to <a href="#rate-limits">API rate limits</a> for more information</td>
</tr>
<tr>
<td style="text-align: left"><code>429</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;TooManyRequestsError&quot;,</code><br><code>&quot;message&quot;: &quot;Exceeded send limits (LIMIT NUMBER) for today&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Refer to <a href="#daily-limits">service limits</a> for the limit number</td>
</tr>
<tr>
<td style="text-align: left">N/A</td>
<td style="text-align: left"><code>&quot;message&quot;:&quot;precompiledPDF must be a valid PDF file&quot;</code></td>
<td style="text-align: left">Send a valid PDF file</td>
</tr>
<tr>
<td style="text-align: left">N/A</td>
<td style="text-align: left"><code>&quot;message&quot;:&quot;reference cannot be null or empty&quot;</code></td>
<td style="text-align: left">Populate the reference parameter</td>
</tr>
<tr>
<td style="text-align: left">N/A</td>
<td style="text-align: left"><code>&quot;message&quot;:&quot;precompiledPDF cannot be null or empty&quot;</code></td>
<td style="text-align: left">Send a PDF file with data in it</td>
</tr>

        </table>
      </div><h1 id="get-message-status-2">Get message status</h1><p>Message status depends on the type of message you have sent.</p>
<p>You can only get the status of messages that are 7 days old or newer.</p>
<h2 id="status-email">Status - email</h2><div class="table-container">
        <table>
          <tr>
<th style="text-align: left">Status</th>
<th style="text-align: left">Information</th>
</tr>
<tr>
<td style="text-align: left">Created</td>
<td style="text-align: left">GOV.UK Notify has placed the message in a queue, ready to be sent to the provider. It should only remain in this state for a few seconds.</td>
</tr>
<tr>
<td style="text-align: left">Sending</td>
<td style="text-align: left">GOV.UK Notify has sent the message to the provider. The provider will try to deliver the message to the recipient for up to 72 hours. GOV.UK Notify is waiting for delivery information.</td>
</tr>
<tr>
<td style="text-align: left">Delivered</td>
<td style="text-align: left">The message was successfully delivered.</td>
</tr>
<tr>
<td style="text-align: left">Failed</td>
<td style="text-align: left">This covers all failure statuses:<br>- <code>permanent-failure</code> - &ldquo;The provider could not deliver the message because the email address was wrong. You should remove these email addresses from your database.&rdquo;<br>- <code>temporary-failure</code> - &ldquo;The provider could not deliver the message. This can happen when the recipient’s inbox is full. You can try to send the message again.&rdquo;<br>- <code>technical-failure</code> - &ldquo;Your message was not sent because there was a problem between Notify and the provider.<br>You’ll have to try sending your messages again.&rdquo;</td>
</tr>

        </table>
      </div><h2 id="status-text-message">Status - text message</h2><div class="table-container">
        <table>
          <tr>
<th style="text-align: left">Status</th>
<th style="text-align: left">Information</th>
</tr>
<tr>
<td style="text-align: left">Created</td>
<td style="text-align: left">GOV.UK Notify has placed the message in a queue, ready to be sent to the provider. It should only remain in this state for a few seconds.</td>
</tr>
<tr>
<td style="text-align: left">Sending</td>
<td style="text-align: left">GOV.UK Notify has sent the message to the provider. The provider will try to deliver the message to the recipient for up to 72 hours. GOV.UK Notify is waiting for delivery information.</td>
</tr>
<tr>
<td style="text-align: left">Pending</td>
<td style="text-align: left">GOV.UK Notify is waiting for more delivery information.<br>GOV.UK Notify received a callback from the provider but the recipient’s device has not yet responded. Another callback from the provider determines the final status of the notification.</td>
</tr>
<tr>
<td style="text-align: left">Sent / Sent internationally</td>
<td style="text-align: left">The message was sent to an international number. The mobile networks in some countries do not provide any more delivery information. The GOV.UK Notify client API returns this status as <code>sent</code>. The GOV.UK Notify client app returns this status as <code>Sent internationally</code>.</td>
</tr>
<tr>
<td style="text-align: left">Delivered</td>
<td style="text-align: left">The message was successfully delivered.</td>
</tr>
<tr>
<td style="text-align: left">Failed</td>
<td style="text-align: left">This covers all failure statuses:<br>- <code>permanent-failure</code> - &ldquo;The provider could not deliver the message. This can happen if the phone number was wrong or if the network operator rejects the message. If you’re sure that these phone numbers are correct, you should <a href="https://www.notifications.service.gov.uk/support">contact GOV.UK Notify support</a>. If not, you should remove them from your database. You’ll still be charged for text messages that cannot be delivered.&rdquo;<br>- <code>temporary-failure</code> - &ldquo;The provider could not deliver the message. This can happen when the recipient’s phone is off, has no signal, or their text message inbox is full. You can try to send the message again. You’ll still be charged for text messages to phones that are not accepting messages.&rdquo;<br>- <code>technical-failure</code> - &ldquo;Your message was not sent because there was a problem between Notify and the provider.<br>You’ll have to try sending your messages again. You will not be charged for text messages that are affected by a technical failure.&rdquo;</td>
</tr>

        </table>
      </div><h2 id="status-letter">Status - letter</h2><div class="table-container">
        <table>
          <tr>
<th style="text-align: left">Status</th>
<th style="text-align: left">information</th>
</tr>
<tr>
<td style="text-align: left">Failed</td>
<td style="text-align: left">The only failure status that applies to letters is <code>technical-failure</code>. GOV.UK Notify had an unexpected error while sending to our printing provider.</td>
</tr>
<tr>
<td style="text-align: left">Accepted</td>
<td style="text-align: left">GOV.UK Notify has sent the letter to the provider to be printed.</td>
</tr>
<tr>
<td style="text-align: left">Received</td>
<td style="text-align: left">The provider has printed and dispatched the letter.</td>
</tr>

        </table>
      </div><h2 id="status-precompiled-letter">Status - precompiled letter</h2><div class="table-container">
        <table>
          <tr>
<th style="text-align: left">Status</th>
<th style="text-align: left">information</th>
</tr>
<tr>
<td style="text-align: left">Pending virus check</td>
<td style="text-align: left">GOV.UK Notify has not completed a virus scan of the precompiled letter file.</td>
</tr>
<tr>
<td style="text-align: left">Virus scan failed</td>
<td style="text-align: left">GOV.UK Notify found a potential virus in the precompiled letter file.</td>
</tr>
<tr>
<td style="text-align: left">Validation failed</td>
<td style="text-align: left">Content in the precompiled letter file is outside the printable area. <a href="https://docs.notifications.service.gov.uk/documentation/images/notify-pdf-letter-spec-v2.3.pdf">See the GOV.UK Notify PDF letter specification</a> for more information.</td>
</tr>

        </table>
      </div><h2 id="get-the-status-of-one-message">Get the status of one message</h2><h3 id="get-the-status-of-one-message-method">Method</h3><div class="highlight"><pre class="highlight javascript"><code><span class="nx">notifyClient</span>
  <span class="p">.</span><span class="nx">getNotificationById</span><span class="p">(</span><span class="nx">notificationId</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre></div><p>The method returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises">promise</a> [external link]. The promise will either:</p>

<ul>
<li>resolve with a <code>response</code> if successful</li>
<li>fail with an <code>err</code> if unsuccessful</li>
</ul>
<h3 id="get-the-status-of-one-message-arguments">Arguments</h3><h4 id="notificationid-required">notificationId (required)</h4><p>The ID of the notification. You can find the notification ID in the response to the original notification method call.</p>
<p>You can also find it by <a href="https://www.notifications.service.gov.uk/sign-in">signing in to GOV.UK Notify</a> and going to the <strong>API integration</strong> page.</p>
<h3 id="get-the-status-of-one-message-response">Response</h3><p>If the request to the client is successful, the promise resolves with an <code>object</code>:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'notify_id'</span><span class="p">,</span>
  <span class="s1">'body'</span><span class="p">:</span> <span class="s1">'Hello Foo'</span><span class="p">,</span>
  <span class="s1">'subject'</span><span class="p">:</span> <span class="s1">'null|email_subject'</span><span class="p">,</span>
  <span class="s1">'reference'</span><span class="p">:</span> <span class="s1">'client reference'</span><span class="p">,</span>
  <span class="s1">'email_address'</span><span class="p">:</span> <span class="s1">'email address'</span><span class="p">,</span>
  <span class="s1">'phone_number'</span><span class="p">:</span> <span class="s1">'phone number'</span><span class="p">,</span>
  <span class="s1">'line_1'</span><span class="p">:</span> <span class="s1">'full name of a person or company'</span><span class="p">,</span>
  <span class="s1">'line_2'</span><span class="p">:</span> <span class="s1">'123 The Street'</span><span class="p">,</span>
  <span class="s1">'line_3'</span><span class="p">:</span> <span class="s1">'Some Area'</span><span class="p">,</span>
  <span class="s1">'line_4'</span><span class="p">:</span> <span class="s1">'Some Town'</span><span class="p">,</span>
  <span class="s1">'line_5'</span><span class="p">:</span> <span class="s1">'Some county'</span><span class="p">,</span>
  <span class="s1">'line_6'</span><span class="p">:</span> <span class="s1">'Something else'</span><span class="p">,</span>
  <span class="s1">'postcode'</span><span class="p">:</span> <span class="s1">'postcode'</span><span class="p">,</span>
  <span class="s1">'postage'</span><span class="p">:</span> <span class="s1">'first or second'</span><span class="p">,</span>
  <span class="s1">'type'</span><span class="p">:</span> <span class="s1">'sms|letter|email'</span><span class="p">,</span>
  <span class="s1">'status'</span><span class="p">:</span> <span class="s1">'current status'</span><span class="p">,</span>
  <span class="s1">'template'</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'version'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">'id'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">'uri'</span><span class="p">:</span> <span class="s1">'/template/{id}/{version}'</span>
  <span class="p">},</span>
  <span class="s1">'created_by_name'</span><span class="p">:</span> <span class="s1">'name of the person who sent the notification if sent manually'</span><span class="p">,</span>
  <span class="s1">'created_at'</span><span class="p">:</span> <span class="s1">'created at'</span><span class="p">,</span>
  <span class="s1">'sent_at'</span><span class="p">:</span> <span class="s1">'sent to provider at'</span>
<span class="p">}</span>
</code></pre></div><h3 id="get-the-status-of-one-message-error-codes">Error codes</h3><p>If the request is not successful, the promise fails with an <code>err</code>.</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">err.error.status_code</th>
<th style="text-align: left">err.error.errors</th>
<th style="text-align: left">How to fix</th>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;ValidationError&quot;,</code><br><code>&quot;message&quot;: &quot;id is not a valid UUID&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check the notification ID</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Error: Your system clock must be accurate to within 30 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check your system clock</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Invalid token: API key not found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Use the correct API key. Refer to <a href="#api-keys">API keys</a> for more information</td>
</tr>
<tr>
<td style="text-align: left"><code>404</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;NoResultFound&quot;,</code><br><code>&quot;message&quot;: &quot;No result found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check the notification ID</td>
</tr>

        </table>
      </div><h2 id="get-the-status-of-multiple-messages">Get the status of multiple messages</h2><p>This API call returns one page of up to 250 messages and statuses. You can get either the most recent messages, or get older messages by specifying a particular notification ID in the <a href="#olderthanid"><code>olderThanId</code></a> argument.</p>
<p>You can only get the status of messages that are 7 days old or newer.</p>
<h3 id="get-the-status-of-multiple-messages-method">Method</h3><div class="highlight"><pre class="highlight javascript"><code><span class="nx">notifyClient</span>
  <span class="p">.</span><span class="nx">getNotifications</span><span class="p">(</span><span class="nx">templateType</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">reference</span><span class="p">,</span> <span class="nx">olderThan</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre></div><p>The method returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises">promise</a> [external link]. The promise will either:</p>

<ul>
<li>resolve with a <code>response</code> if successful</li>
<li>fail with an <code>err</code> if unsuccessful</li>
</ul>
<p>To get the most recent messages, you must pass in an empty <code>olderThan</code> argument or <code>null</code>.</p>
<p>To get older messages, pass the ID of an older notification into the <code>olderThan</code> argument. This returns the next oldest messages from the specified notification ID.</p>
<h3 id="get-the-status-of-multiple-messages-arguments">Arguments</h3><p>You can pass in empty arguments or <code>null</code> to ignore these filters.</p>
<h4 id="status-optional">status (optional)</h4><p>You can filter by each:</p>

<ul>
<li><a href="#status-email">email status</a></li>
<li><a href="#status-text-message">text message status</a></li>
<li><a href="#status-letter">letter status</a></li>
<li><a href="#status-precompiled-letter">precompiled letter status</a></li>
</ul>
<p>You can leave out this argument to ignore this filter.</p>
<h4 id="notificationtype-optional">notificationType (optional)</h4><p>You can filter by:</p>

<ul>
<li><code>email</code></li>
<li><code>sms</code></li>
<li><code>letter</code></li>
</ul>
<h4 id="get-the-status-of-multiple-messages-arguments-reference-optional">reference (optional)</h4><p>A unique identifier you create if necessary. This reference identifies a single unique notification or a batch of notifications. It must not contain any personal information such as name or postal address. For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>"your_reference_here"
</code></pre></div><h4 id="olderthan-optional">olderThan (optional)</h4><p>Input the ID of a notification into this argument. If you use this argument, the client returns the next 250 received notifications older than the given ID. For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>"8e222534-7f05-4972-86e3-17c5d9f894e2"
</code></pre></div><p>If you pass in an empty argument or <code>null</code>, the client returns the most recent 250 notifications.</p>
<h3 id="get-the-status-of-multiple-messages-response">Response</h3><p>If the request to the client is successful, the promise resolves with an <code>object</code>:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s1">'notifications'</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'notify_id'</span><span class="p">,</span>
      <span class="s1">'reference'</span><span class="p">:</span> <span class="s1">'client reference'</span><span class="p">,</span>
      <span class="s1">'email_address'</span><span class="p">:</span> <span class="s1">'email address'</span><span class="p">,</span>
      <span class="s1">'phone_number'</span><span class="p">:</span> <span class="s1">'phone number'</span><span class="p">,</span>
      <span class="s1">'line_1'</span><span class="p">:</span> <span class="s1">'full name of a person or company'</span><span class="p">,</span>
      <span class="s1">'line_2'</span><span class="p">:</span> <span class="s1">'123 The Street'</span><span class="p">,</span>
      <span class="s1">'line_3'</span><span class="p">:</span> <span class="s1">'Some Area'</span><span class="p">,</span>
      <span class="s1">'line_4'</span><span class="p">:</span> <span class="s1">'Some Town'</span><span class="p">,</span>
      <span class="s1">'line_5'</span><span class="p">:</span> <span class="s1">'Some county'</span><span class="p">,</span>
      <span class="s1">'line_6'</span><span class="p">:</span> <span class="s1">'Something else'</span><span class="p">,</span>
      <span class="s1">'postcode'</span><span class="p">:</span> <span class="s1">'postcode'</span><span class="p">,</span>
      <span class="s1">'postage'</span><span class="p">:</span> <span class="s1">'first or second'</span><span class="p">,</span>
      <span class="s1">'type'</span><span class="p">:</span> <span class="s1">'sms | letter | email'</span><span class="p">,</span>
      <span class="s1">'status'</span><span class="p">:</span> <span class="s1">'sending | delivered | permanent-failure | temporary-failure | technical-failure'</span><span class="p">,</span>
      <span class="s1">'template'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">'version'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">'id'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">'uri'</span><span class="p">:</span> <span class="s1">'/template/{id}/{version}'</span>
      <span class="p">},</span>
      <span class="s1">'created_by_name'</span><span class="p">:</span> <span class="s1">'name of the person who sent the notification if sent manually'</span><span class="p">,</span>
      <span class="s1">'created_at'</span><span class="p">:</span> <span class="s1">'created at'</span><span class="p">,</span>
      <span class="s1">'sent_at'</span><span class="p">:</span> <span class="s1">'sent to provider at'</span>
    <span class="p">}</span>
    <span class="c1">// …</span>
  <span class="p">],</span>
  <span class="s1">'links'</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'current'</span><span class="p">:</span> <span class="s1">'/notifications?template_type=sms&amp;status=delivered'</span><span class="p">,</span>
    <span class="s1">'next'</span><span class="p">:</span> <span class="s1">'/notifications?other_than=last_id_in_list&amp;template_type=sms&amp;status=delivered'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h3 id="get-the-status-of-multiple-messages-error-codes">Error codes</h3><p>If the request is not successful, the promise fails with an <code>err</code>.</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">err.error.status_code</th>
<th style="text-align: left">err.error.errors</th>
<th style="text-align: left">How to fix</th>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;ValidationError&quot;,</code><br><code>&quot;message&quot;: &quot;bad status is not one of [created, sending, sent, delivered, pending, failed, technical-failure, temporary-failure, permanent-failure, accepted, received]&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Contact the GOV.UK Notify team</td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;ValidationError&quot;,</code><br><code>&quot;message&quot;: &quot;Applet is not one of [sms, email, letter]&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Contact the GOV.UK Notify team</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Error: Your system clock must be accurate to within 30 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check your system clock</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Invalid token: API key not found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Use the correct API key. Refer to <a href="#api-keys">API keys</a> for more information</td>
</tr>

        </table>
      </div><h2 id="get-a-pdf-for-a-letter-notification">Get a PDF for a letter notification</h2><h3 id="get-a-pdf-for-a-letter-notification-method">Method</h3><div class="highlight"><pre class="highlight javascript"><code><span class="nx">notifyClient</span>
  <span class="p">.</span><span class="nx">getPdfForLetterNotification</span><span class="p">(</span><span class="nx">notificationId</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">fileBuffer</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fileBuffer</span>
  <span class="p">})</span> <span class="cm">/* the response is a file buffer, an instance of Buffer */</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre></div><p>The method returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises">promise</a> [external link]. The promise will either:</p>

<ul>
<li>resolve with <code>fileBuffer</code> if successful</li>
<li>fail with an <code>err</code> if unsuccessful</li>
</ul>
<h3 id="get-a-pdf-for-a-letter-notification-arguments">Arguments</h3><h4 id="notification-id-required">notification_id (required)</h4><p>The ID of the notification. You can find the notification ID in the response to the <a href="/python.html#get-the-status-of-one-message-response">original notification method call</a>.</p>
<p>You can also find it by <a href="https://www.notifications.service.gov.uk/sign-in">signing in to GOV.UK Notify</a> and going to the <strong>API integration</strong> page.</p>
<h3 id="get-a-pdf-for-a-letter-notification-response">Response</h3><p>If the request to the client is successful, the client will return an instance of the <a href="https://nodejs.org/api/buffer.html#buffer_buffer">Buffer</a> class containing the raw PDF data.</p>
<h3 id="get-a-pdf-for-a-letter-notification-error-codes">Error codes</h3><p>If the request is not successful, the client will return an <code>HTTPError</code> containing the relevant error code:</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">error.status_code</th>
<th style="text-align: left">error.message</th>
<th style="text-align: left">How to fix</th>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;ValidationError&quot;,</code><br><code>&quot;message&quot;: &quot;id is not a valid UUID&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check the notification ID</td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;PDFNotReadyError&quot;,</code><br><code>&quot;message&quot;: &quot;PDF not available yet, try again later&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Wait for the notification to finish processing. This usually takes a few seconds</td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;File did not pass the virus scan&quot;</code><br><code>}]</code></td>
<td style="text-align: left">You cannot retrieve the contents of a letter notification that contains a virus</td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;PDF not available for letters in technical-failure&quot;</code><br><code>}]</code></td>
<td style="text-align: left">You cannot retrieve the contents of a letter notification in technical-failure</td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;ValidationError&quot;,</code><br><code>&quot;message&quot;: &quot;Notification is not a letter&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check that you are looking up the correct notification</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Error: Your system clock must be accurate to within 30 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check your system clock</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Invalid token: API key not found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Use the correct API key. Refer to <a href="#api-keys">API keys</a> for more information</td>
</tr>
<tr>
<td style="text-align: left"><code>404</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;NoResultFound&quot;,</code><br><code>&quot;message&quot;: &quot;No result found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check the notification ID</td>
</tr>

        </table>
      </div><h1 id="get-a-template">Get a template</h1><h2 id="get-a-template-by-id">Get a template by ID</h2><h3 id="get-a-template-by-id-method">Method</h3><p>This returns the latest version of the template.</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="nx">notifyClient</span>
  <span class="p">.</span><span class="nx">getTemplateById</span><span class="p">(</span><span class="nx">templateId</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre></div><p>The method returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises">promise</a> [external link]. The promise will either:</p>

<ul>
<li>resolve with a <code>response</code> if successful</li>
<li>fail with an <code>err</code> if unsuccessful</li>
</ul>
<h3 id="get-a-template-by-id-arguments">Arguments</h3><h4 id="get-a-template-by-id-arguments-templateid-required">templateId (required)</h4><p>The ID of the template. <a href="https://www.notifications.service.gov.uk/sign-in">Sign in to GOV.UK Notify</a> and go to the <strong>Templates</strong> page to find it. For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>"f33517ff-2a88-4f6e-b855-c550268ce08a"
</code></pre></div><h3 id="get-a-template-by-id-response">Response</h3><p>If the request to the client is successful, the promise resolves with an <code>object</code>:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'template_id'</span><span class="p">,</span>
  <span class="s1">'name'</span><span class="p">:</span> <span class="s1">'template name'</span><span class="p">,</span>
  <span class="s1">'type'</span><span class="p">:</span> <span class="s1">'sms|email|letter'</span><span class="p">,</span>
  <span class="s1">'created_at'</span><span class="p">:</span> <span class="s1">'created at'</span><span class="p">,</span>
  <span class="s1">'updated_at'</span><span class="p">:</span> <span class="s1">'updated at'</span><span class="p">,</span>
  <span class="s1">'version'</span><span class="p">:</span> <span class="s1">'version'</span><span class="p">,</span>
  <span class="s1">'created_by'</span><span class="p">:</span> <span class="s1">'someone@example.com'</span><span class="p">,</span>
  <span class="s1">'body'</span><span class="p">:</span> <span class="s1">'body'</span><span class="p">,</span>
  <span class="s1">'subject'</span><span class="p">:</span> <span class="s1">'null|email_subject'</span>
<span class="p">}</span>
</code></pre></div><h3 id="get-a-template-by-id-error-codes">Error codes</h3><p>If the request is not successful, the promise fails with an <code>err</code>.</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">err.error.status_code</th>
<th style="text-align: left">err.error.errors</th>
<th style="text-align: left">How to fix</th>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Error: Your system clock must be accurate to within 30 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check your system clock</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Invalid token: API key not found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Use the correct API key. Refer to <a href="#api-keys">API keys</a> for more information</td>
</tr>
<tr>
<td style="text-align: left"><code>404</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;NoResultFound&quot;,</code><br><code>&quot;message&quot;: &quot;No Result Found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check your <a href="#arguments-template-id-required">template ID</a></td>
</tr>

        </table>
      </div><h2 id="get-a-template-by-id-and-version">Get a template by ID and version</h2><h3 id="get-a-template-by-id-and-version-method">Method</h3><div class="highlight"><pre class="highlight javascript"><code><span class="nx">notifyClient</span>
  <span class="p">.</span><span class="nx">getTemplateByIdAndVersion</span><span class="p">(</span><span class="nx">templateId</span><span class="p">,</span> <span class="nx">version</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre></div><p>The method returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises">promise</a> [external link]. The promise will either:</p>

<ul>
<li>resolve with a <code>response</code> if successful</li>
<li>fail with an <code>err</code> if unsuccessful</li>
</ul>
<h3 id="get-a-template-by-id-and-version-arguments">Arguments</h3><h4 id="get-a-template-by-id-and-version-arguments-templateid-required">templateId (required)</h4><p>The ID of the template. <a href="https://www.notifications.service.gov.uk/sign-in">Sign in to GOV.UK Notify</a> and go to the <strong>Templates</strong> page to find it. For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>"f33517ff-2a88-4f6e-b855-c550268ce08a"
</code></pre></div><h4 id="version-required">version (required)</h4><p>The version number of the template.</p>
<h3 id="get-a-template-by-id-and-version-response">Response</h3><p>If the request to the client is successful, the promise resolves with an <code>object</code>:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'template_id'</span><span class="p">,</span>
  <span class="s1">'name'</span><span class="p">:</span> <span class="s1">'template name'</span><span class="p">,</span>
  <span class="s1">'type'</span><span class="p">:</span> <span class="s1">'sms|email|letter'</span><span class="p">,</span>
  <span class="s1">'created_at'</span><span class="p">:</span> <span class="s1">'created at'</span><span class="p">,</span>
  <span class="s1">'updated_at'</span><span class="p">:</span> <span class="s1">'updated at'</span><span class="p">,</span>
  <span class="s1">'version'</span><span class="p">:</span> <span class="s1">'version'</span><span class="p">,</span>
  <span class="s1">'created_by'</span><span class="p">:</span> <span class="s1">'someone@example.com'</span><span class="p">,</span>
  <span class="s1">'body'</span><span class="p">:</span> <span class="s1">'body'</span><span class="p">,</span>
  <span class="s1">'subject'</span><span class="p">:</span> <span class="s1">'null|email_subject'</span>
<span class="p">}</span>
</code></pre></div><h3 id="get-a-template-by-id-and-version-error-codes">Error codes</h3><p>If the request is not successful, the promise fails with an <code>err</code>.</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">err.error.status_code</th>
<th style="text-align: left">err.error.errors</th>
<th style="text-align: left">How to fix</th>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;ValidationError&quot;,</code><br><code>&quot;message&quot;: &quot;id is not a valid UUID&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check the notification ID</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Error: Your system clock must be accurate to within 30 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check your system clock</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Invalid token: API key not found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Use the correct API key. Refer to <a href="#api-keys">API keys</a> for more information</td>
</tr>
<tr>
<td style="text-align: left"><code>404</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;NoResultFound&quot;,</code><br><code>&quot;message&quot;: &quot;No Result Found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check your <a href="#get-a-template-by-id-and-version-arguments-template-id-required">template ID</a> and <a href="#version">version</a></td>
</tr>

        </table>
      </div><h2 id="get-all-templates">Get all templates</h2><h3 id="get-all-templates-method">Method</h3><p>This returns the latest version of all templates.</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="nx">notifyClient</span>
  <span class="p">.</span><span class="nx">getAllTemplates</span><span class="p">(</span><span class="nx">templateType</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre></div><p>The method returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises">promise</a> [external link]. The promise will either:</p>

<ul>
<li>resolve with a <code>response</code> if successful</li>
<li>fail with an <code>err</code> if unsuccessful</li>
</ul>
<h3 id="get-all-templates-arguments">Arguments</h3><h4 id="templatetype-optional">templateType (optional)</h4><p>If you do not use <code>templateType</code>, the client returns all templates. Otherwise you can filter by:</p>

<ul>
<li><code>email</code></li>
<li><code>sms</code></li>
<li><code>letter</code></li>
</ul>
<h3 id="get-all-templates-response">Response</h3><p>If the request to the client is successful, the promise resolves with an <code>object</code>:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s1">'templates'</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'template_id'</span><span class="p">,</span>
      <span class="s1">'name'</span><span class="p">:</span> <span class="s1">'template name'</span><span class="p">,</span>
      <span class="s1">'type'</span><span class="p">:</span> <span class="s1">'sms|email|letter'</span><span class="p">,</span>
      <span class="s1">'created_at'</span><span class="p">:</span> <span class="s1">'created at'</span><span class="p">,</span>
      <span class="s1">'updated_at'</span><span class="p">:</span> <span class="s1">'updated at'</span><span class="p">,</span>
      <span class="s1">'version'</span><span class="p">:</span> <span class="s1">'version'</span><span class="p">,</span>
      <span class="s1">'created_by'</span><span class="p">:</span> <span class="s1">'someone@example.com'</span><span class="p">,</span>
      <span class="s1">'body'</span><span class="p">:</span> <span class="s1">'body'</span><span class="p">,</span>
      <span class="s1">'subject'</span><span class="p">:</span> <span class="s1">'null|email_subject'</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="c1">// … another template</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div><p>If no templates exist for a template type or there no templates for a service, the object is empty.</p>
<h2 id="generate-a-preview-template">Generate a preview template</h2><h3 id="generate-a-preview-template-method">Method</h3><p>This generates a preview version of a template.</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="nx">personalisation</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">'foo'</span><span class="p">:</span> <span class="s1">'bar'</span> <span class="p">}</span>
<span class="nx">notifyClient</span>
  <span class="p">.</span><span class="nx">previewTemplateById</span><span class="p">(</span><span class="nx">templateId</span><span class="p">,</span> <span class="nx">personalisation</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre></div><p>The method returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises">promise</a> [external link]. The promise will either:</p>

<ul>
<li>resolve with a <code>response</code> if successful</li>
<li>fail with an <code>err</code> if unsuccessful</li>
</ul>
<p>The parameters in the personalisation argument must match the placeholder fields in the actual template. The API notification client ignores any extra fields in the method.</p>
<h3 id="generate-a-preview-template-arguments">Arguments</h3><h4 id="generate-a-preview-template-arguments-templateid-required">templateId (required)</h4><p>The ID of the template. <a href="https://www.notifications.service.gov.uk/sign-in">Sign in to GOV.UK Notify</a> and go to the <strong>Templates</strong> page to find it. For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>"f33517ff-2a88-4f6e-b855-c550268ce08a"
</code></pre></div><h4 id="generate-a-preview-template-arguments-personalisation-optional">personalisation (optional)</h4><p>If a template has placeholder fields for personalised information such as name or application date, you must provide their values in an <code>object</code>. For example:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="nl">personalisation</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'first_name'</span><span class="p">:</span> <span class="s1">'Amala'</span><span class="p">,</span>
    <span class="s1">'reference_number'</span><span class="p">:</span> <span class="s1">'300241'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>You can leave out this argument if a template does not have any placeholder fields for personalised information.</p>
<h3 id="generate-a-preview-template-response">Response</h3><p>If the request to the client is successful, the promise resolves with an <code>object</code>:</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'notify_id'</span><span class="p">,</span>
  <span class="s1">'type'</span><span class="p">:</span> <span class="s1">'sms|email|letter'</span><span class="p">,</span>
  <span class="s1">'version'</span><span class="p">:</span> <span class="s1">'version'</span><span class="p">,</span>
  <span class="s1">'body'</span><span class="p">:</span> <span class="s1">'Hello bar'</span><span class="p">,</span> <span class="c1">// with substitution values</span>
  <span class="s1">'subject'</span><span class="p">:</span> <span class="s1">'null|email_subject'</span><span class="p">,</span>
  <span class="s1">'html'</span><span class="p">:</span> <span class="s1">'&lt;p&gt;Example&lt;/p&gt;'</span> <span class="c1">// Returns the rendered body (email templates only)</span>
<span class="p">}</span>
</code></pre></div><h3 id="generate-a-preview-template-error-codes">Error codes</h3><p>If the request is not successful, the promise fails with an <code>err</code>.</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">err.error.status_code</th>
<th style="text-align: left">err.error.errors</th>
<th style="text-align: left">How to fix</th>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;BadRequestError&quot;,</code><br><code>&quot;message&quot;: &quot;Missing personalisation: [PERSONALISATION FIELD]&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check that the personalisation arguments in the method match the placeholder fields in the template</td>
</tr>
<tr>
<td style="text-align: left"><code>400</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;NoResultFound&quot;,</code><br><code>&quot;message&quot;: &quot;No result found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check the <a href="#generate-a-preview-template-required-arguments-template-id">template ID</a></td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Error: Your system clock must be accurate to within 30 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check your system clock</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Invalid token: API key not found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Use the correct API key. Refer to <a href="#api-keys">API keys</a> for more information</td>
</tr>

        </table>
      </div><h1 id="get-received-text-messages">Get received text messages</h1><p>This API call returns one page of up to 250 received text messages. You can get either the most recent messages, or get older messages by specifying a particular notification ID in the <a href="#olderThanId"><code>olderThanId</code></a> argument.</p>
<p>You can only get messages that are 7 days old or newer.</p>
<p>You can also set up <a href="#callbacks">callbacks</a> for received text messages.</p>
<h2 id="enable-received-text-messages">Enable received text messages</h2><p>Contact the GOV.UK Notify team using the <a href="https://www.notifications.service.gov.uk/support">support page</a> or <a href="https://ukgovernmentdigital.slack.com/messages/C0E1ADVPC">chat to us on Slack</a> to request a unique number for text message replies.</p>
<h2 id="get-a-page-of-received-text-messages">Get a page of received text messages</h2><h3 id="get-a-page-of-received-text-messages-method">Method</h3><div class="highlight"><pre class="highlight javascript"><code><span class="nx">notifyClient</span>
  <span class="p">.</span><span class="nx">getReceivedTexts</span><span class="p">(</span><span class="nx">olderThan</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">))</span>
</code></pre></div><p>The method returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises">promise</a> [external link]. The promise will either:</p>

<ul>
<li>resolve with a <code>response</code> if successful</li>
<li>fail with an <code>err</code> if unsuccessful</li>
</ul>
<p>To get the most recent messages, you must pass in an empty argument or <code>null</code>.</p>
<p>To get older messages, pass the ID of an older notification into the <code>olderThan</code> argument. This returns the next oldest messages from the specified notification ID.</p>
<h3 id="get-a-page-of-received-text-messages-arguments">Arguments</h3><h4 id="get-a-page-of-received-text-messages-arguments-olderthan-optional">olderThan (optional)</h4><p>Input the ID of a received text message into this argument. If you use this argument, the client returns the next 250 received text messages older than the given ID. For example:</p>
<div class="highlight"><pre class="highlight plaintext"><code>8e222534-7f05-4972-86e3-17c5d9f894e2"
</code></pre></div><p>If you pass in an empty argument or <code>null</code>, the client returns the most recent 250 text messages.</p>
<h3 id="get-a-page-of-received-text-messages-response">Response</h3><p>If the request to the client is successful, the promise resolves with an <code>object</code> containing all received texts.</p>
<div class="highlight"><pre class="highlight javascript"><code><span class="p">{</span>
  <span class="s1">'received_text_messages'</span><span class="p">:</span>
        <span class="p">[</span>
          <span class="p">{</span>
            <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'notify_id'</span><span class="p">,</span> <span class="c1">// required</span>
            <span class="s1">'user_number'</span><span class="p">:</span> <span class="s1">'user number'</span><span class="p">,</span> <span class="c1">// required user number</span>
            <span class="s1">'notify_number'</span><span class="p">:</span> <span class="s1">'notify number'</span><span class="p">,</span> <span class="c1">// receiving number</span>
            <span class="s1">'created_at'</span><span class="p">:</span> <span class="s1">'created at'</span><span class="p">,</span> <span class="c1">// required</span>
            <span class="s1">'service_id'</span><span class="p">:</span> <span class="s1">'service id'</span><span class="p">,</span> <span class="c1">// required service id</span>
            <span class="s1">'content'</span><span class="p">:</span> <span class="s1">'text content'</span> <span class="c1">// required text content</span>
          <span class="p">}</span>
          <span class="c1">// …</span>
        <span class="p">],</span>
  <span class="s1">'links'</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'current'</span><span class="p">:</span> <span class="s1">'/received-test-messages'</span><span class="p">,</span>
    <span class="s1">'next'</span><span class="p">:</span> <span class="s1">'/received-text-messages?older_than=last_id_in_list'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>If the notification specified in the <code>olderThan</code> argument is older than 7 days, the promise resolves an empty response.</p>
<h3 id="get-a-page-of-received-text-messages-error-codes">Error codes</h3><p>If the request is not successful, the promise fails with an <code>err</code>.</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">err.error.status_code</th>
<th style="text-align: left">err.error.errors</th>
<th style="text-align: left">How to fix</th>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Error: Your system clock must be accurate to within 30 seconds&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Check your system clock</td>
</tr>
<tr>
<td style="text-align: left"><code>403</code></td>
<td style="text-align: left"><code>[{</code><br><code>&quot;error&quot;: &quot;AuthError&quot;,</code><br><code>&quot;message&quot;: &quot;Invalid token: API key not found&quot;</code><br><code>}]</code></td>
<td style="text-align: left">Use the correct API key. Refer to <a href="#api-keys">API keys</a> for more information</td>
</tr>

        </table>
      </div><p><h1 id="testing">Testing</h1><p>All testing takes place in the production environment. There is no test environment for GOV.UK Notify.</p>
<h2 id="smoke-testing">Smoke testing</h2><p>If you need to <a href="https://www.gov.uk/service-manual/technology/deploying-software-regularly#using-smoke-tests-after-you-deploy">smoke test</a> your integration with Notify on a regular basis, you  must use the following smoke test phone numbers and email addresses.</p></p>

<div style="height:1px;font-size:1px;">&nbsp;</div>

<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">Phone number</th>
</tr>
<tr>
<td style="text-align: left">07700900000</td>
</tr>
<tr>
<td style="text-align: left">07700900111</td>
</tr>
<tr>
<td style="text-align: left">07700900222</td>
</tr>

        </table>
      </div><div class="table-container">
        <table>
          <tr>
<th style="text-align: left">Email address</th>
</tr>
<tr>
<td style="text-align: left">simulate-delivered@notifications.service.gov.uk</td>
</tr>
<tr>
<td style="text-align: left">simulate-delivered-2@notifications.service.gov.uk</td>
</tr>
<tr>
<td style="text-align: left">simulate-delivered-3@notifications.service.gov.uk</td>
</tr>

        </table>
      </div><p>The smoke test phone numbers and email addresses will validate the request and simulate a successful response, but will not send a real message, produce a delivery receipt or persist the notification to the database.</p>
<p>You can use these smoke test numbers and addresses with any <a href="#api-keys">type of API key</a>.</p>
<p>You can smoke test all Notify API client functions except:</p>

<ul>
<li>Get the status of one message</li>
<li>Get the status of all messages</li>
</ul>
<p>You cannot use the smoke test phone numbers or email address with these functions because they return a fake <code>notification_ID</code>. If you need to test these functions, use a test API key and any other phone number or email.</p>
<h2 id="other-testing">Other testing</h2><p>You must use a <a href="#test">test API key</a> to do non-smoke testing such as performance or integration testing. You can use any non-smoke testing phone numbers or email addresses. You do not need a specific Notify testing account.</p>

<h1 id="api-keys">API keys</h1><p>There are three different types of API keys:</p>

<ul>
<li>test</li>
<li>team and whitelist</li>
<li>live</li>
</ul>
<p>When you set up a new service it will start in <a href="https://www.notifications.service.gov.uk/features/trial-mode">trial mode</a>. A service in trial mode can create test and team and whitelist keys. You must have a live service to create a live key.</p>
<p>To create an API key:</p>

<ol>
<li><a href="https://www.notifications.service.gov.uk/sign-in">Sign in to GOV.UK Notify</a>.</li>
<li>Go to the <strong>API integration</strong> page.</li>
<li>Select <strong>API keys</strong>.</li>
<li>Select <strong>Create an API key</strong>.</li>
</ol>
<h2 id="test">Test</h2><p>Use a test key to test the performance of your service and its integration with GOV.UK Notify.</p>
<p>Messages sent using a test key:</p>

<ul>
<li>generate realistic responses</li>
<li>result in a delivered status</li>
<li>are not actually delivered to a recipient</li>
<li>do not appear on your dashboard</li>
<li>do not count against your text message and email allowances</li>
</ul>
<p>To test failure responses with a test key, use the following numbers and addresses:</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">Phone number/Email address</th>
<th style="text-align: left">Response</th>
</tr>
<tr>
<td style="text-align: left">07700900003</td>
<td style="text-align: left"><code>temporary-failure</code></td>
</tr>
<tr>
<td style="text-align: left">07700900002</td>
<td style="text-align: left"><code>permanent-failure</code></td>
</tr>
<tr>
<td style="text-align: left">temp-fail@simulator.notify</td>
<td style="text-align: left"><code>temporary-failure</code></td>
</tr>
<tr>
<td style="text-align: left">perm-fail@simulator.notify</td>
<td style="text-align: left"><code>permanent-failure</code></td>
</tr>
<tr>
<td style="text-align: left">any other valid number or address</td>
<td style="text-align: left"><code>delivered</code></td>
</tr>

        </table>
      </div><p>You do not have to revoke test keys.</p>
<h2 id="team-and-guest-list">Team and guest list</h2><p>A team and guest list key lets you send real messages to your team members and addresses/numbers on your guest list while your service is still in trial mode.</p>
<p>You will get an error if you use these keys to send messages to anyone who is not on your team or your guest list.</p>
<p>Messages sent with a team and guest list key appear on your dashboard and count against your text message and email allowances.</p>
<p>You do not have to revoke team and guest list keys.</p>
<h2 id="live">Live</h2><p>You can only create live keys once your service is live. You can use live keys to send messages to anyone.</p>
<p>Messages sent with a live key appear on your dashboard and count against your text message and email allowances.</p>
<p>You should revoke and re-create these keys on a regular basis. To revoke a key:</p>

<ol>
<li><a href="https://www.notifications.service.gov.uk/sign-in">Sign in to GOV.UK Notify</a>.</li>
<li>Go to the <strong>API integration</strong> page.</li>
<li>Select <strong>API keys</strong>.</li>
<li>Select <strong>Revoke</strong> for the API key you want to revoke.</li>
</ol>
<p>You can have more than one active key at a time.</p>
<p>You should never send test messages to invalid numbers or addresses using a live key.</p>

<h1 id="limits">Limits</h1><h2 id="rate-limits">Rate limits</h2><p>You’re limited to sending 3,000 messages per minute.</p>
<p>This limit is calculated on a rolling basis, per API key type. If you exceed the limit, you will get a <code>429</code> error <code>RateLimitError</code>.</p>
<h2 id="daily-limits">Daily limits</h2><p>There’s a limit to the number of messages you can send each day:</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">Service status</th>
<th style="text-align: left">Type of API key</th>
<th style="text-align: left">Daily limit</th>
</tr>
<tr>
<td style="text-align: left">Live</td>
<td style="text-align: left">Team or live</td>
<td style="text-align: left">250,000</td>
</tr>
<tr>
<td style="text-align: left">Trial</td>
<td style="text-align: left">Team</td>
<td style="text-align: left">50</td>
</tr>
<tr>
<td style="text-align: left">Live or trial</td>
<td style="text-align: left">Test</td>
<td style="text-align: left">Unlimited</td>
</tr>

        </table>
      </div><p>These limits reset at midnight.</p>
<h2 id="phone-network-limits">Phone network limits</h2><p>If you repeatedly send text messages to the same number the phone networks will block them.</p>
<p>There’s an hourly limit of:</p>

<ul>
<li>20 messages with the same content</li>
<li>100 messages with any content</li>
</ul>
<p>Your messages may not be delivered if you exceed these limits.</p>

<h1 id="callbacks">Callbacks</h1><p>Callbacks are when GOV.UK Notify sends <code>POST</code> requests to your service. You can get callbacks when:</p>

<ul>
<li>a text message or email you’ve sent is delivered or fails</li>
<li>your service receives a text message</li>
</ul>
<h2 id="set-up-callbacks">Set up callbacks</h2><p>You must provide:</p>

<ul>
<li>a URL where Notify will post the callback to</li>
<li>a bearer token which Notify will put in the authorisation header of the requests</li>
</ul>
<p>To do this:</p>

<ol>
<li><a href="https://www.notifications.service.gov.uk/sign-in">Sign in to GOV.UK Notify</a>.</li>
<li>Go to the <strong>API integration</strong> page.</li>
<li>Select <strong>Callbacks</strong>.</li>
</ol>
<h2 id="delivery-receipts">Delivery receipts</h2><p>When you send an email or text message, Notify will send a receipt to your callback URL with the status of the message. This is an automated method to get the status of messages.</p>
<p>This functionality works with test API keys, but does not work with smoke testing phone numbers or email addresses.</p>
<p>The callback message is formatted in JSON. The key, description and format of the callback message arguments will be:</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">Key</th>
<th style="text-align: left">Description</th>
<th style="text-align: left">Format</th>
</tr>
<tr>
<td style="text-align: left"><code>id</code></td>
<td style="text-align: left">Notify’s id for the status receipts</td>
<td style="text-align: left">UUID</td>
</tr>
<tr>
<td style="text-align: left"><code>reference</code></td>
<td style="text-align: left">The reference sent by the service</td>
<td style="text-align: left">12345678</td>
</tr>
<tr>
<td style="text-align: left"><code>to</code></td>
<td style="text-align: left">The email address or phone number of the recipient</td>
<td style="text-align: left">hello@gov.uk or 07700912345</td>
</tr>
<tr>
<td style="text-align: left"><code>status</code></td>
<td style="text-align: left">The status of the notification</td>
<td style="text-align: left"><code>delivered</code>, <code>permanent-failure</code>, <code>temporary-failure</code> or <code>technical-failure</code></td>
</tr>
<tr>
<td style="text-align: left"><code>created_at</code></td>
<td style="text-align: left">The time the service sent the request</td>
<td style="text-align: left"><code>2017-05-14T12:15:30.000000Z</code></td>
</tr>
<tr>
<td style="text-align: left"><code>completed_at</code></td>
<td style="text-align: left">The last time the status was updated</td>
<td style="text-align: left"><code>2017-05-14T12:15:30.000000Z</code> or nil</td>
</tr>
<tr>
<td style="text-align: left"><code>sent_at</code></td>
<td style="text-align: left">The time the notification was sent</td>
<td style="text-align: left"><code>2017-05-14T12:15:30.000000Z</code> or nil</td>
</tr>
<tr>
<td style="text-align: left"><code>notification_type</code></td>
<td style="text-align: left">The notification type</td>
<td style="text-align: left"><code>email</code> or <code>sms</code></td>
</tr>

        </table>
      </div><h2 id="received-text-messages">Received text messages</h2><p>If your service receives text messages in Notify, Notify can forward them to your callback URL as soon as they arrive.</p>
<p>Contact the Notify team using the <a href="https://www.notifications.service.gov.uk/support">support page</a> or <a href="https://ukgovernmentdigital.slack.com/messages/C0E1ADVPC">chat to us on Slack</a> to request a unique number for text message replies.</p>
<p>The callback message is formatted in JSON. The key, description and format of the callback message arguments will be:</p>
<div class="table-container">
        <table>
          <tr>
<th style="text-align: left">Key</th>
<th style="text-align: left">Description</th>
<th style="text-align: left">Format</th>
</tr>
<tr>
<td style="text-align: left"><code>id</code></td>
<td style="text-align: left">Notify’s id for the received message</td>
<td style="text-align: left">UUID</td>
</tr>
<tr>
<td style="text-align: left"><code>source_number</code></td>
<td style="text-align: left">The phone number the message was sent from</td>
<td style="text-align: left">447700912345</td>
</tr>
<tr>
<td style="text-align: left"><code>destination_number</code></td>
<td style="text-align: left">The number the message was sent to (your number)</td>
<td style="text-align: left">07700987654</td>
</tr>
<tr>
<td style="text-align: left"><code>message</code></td>
<td style="text-align: left">The received message</td>
<td style="text-align: left">Hello Notify!</td>
</tr>
<tr>
<td style="text-align: left"><code>date_received</code></td>
<td style="text-align: left">The UTC datetime that the message was received by Notify</td>
<td style="text-align: left">2017-05-14T12:15:30.000000Z</td>
</tr>

        </table>
      </div>
<p><h1 id="api-architecture">API architecture</h1><h2 id="send-a-message">Send a message</h2><p><a href="documentation/images/notify-send-a-message.png" target="_blank" rel="noopener noreferrer"><img src="/documentation/images/notify-send-a-message.png" alt="" /></a></p>
<h2 id="get-message-status">Get message status</h2><p><a href="documentation/images/notify-get-message-status.png" target="_blank" rel="noopener noreferrer"><img src="/documentation/images/notify-get-message-status.png" alt="" /></a></p>
<h2 id="get-inbound-messages">Get inbound messages</h2><p><a href="documentation/images/notify-get-inbound-messages.png" target="_blank" rel="noopener noreferrer"><img src="/documentation/images/notify-get-inbound-messages.png" alt="" /></a></p></p>
<p><h1 id="support">Support</h1><p>Report any problems via the <a href="https://www.notifications.service.gov.uk/support">GOV.UK Notify support page</a>.</p>
<p>You can also:</p></p>

<ul>
<li>check the <a href="https://status.notifications.service.gov.uk/">GOV.UK Notify system status page</a></li>
<li>ask the team on the GOV.UK Notify <a href="https://ukgovernmentdigital.slack.com/messages/C0E1ADVPC">Slack channel</a></li>
</ul>


          </main>

          <aside>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">


      <svg
        role="presentation"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>


    <script src="/javascripts/application.js"></script>
  </body>





{% endblock %}
